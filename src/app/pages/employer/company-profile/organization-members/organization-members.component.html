<div class="p-6 space-y-8">
  <!-- Header -->
  <div class="flex flex-col md:flex-row md:items-center md:justify-between">
    <div>
      <h2 class="text-2xl font-bold tracking-tight">Organization Members</h2>
      <p class="text-muted-foreground mt-1">Manage your team members and pending invitations.</p>
    </div>
    <div class="mt-4 md:mt-0">
      <button (click)="openInviteDialog()" class="w-full md:w-auto flex items-center justify-center gap-2 rounded-full bg-primary px-6 py-3 text-base font-bold text-primary-foreground transition-all duration-300 ease-in-out hover:bg-primary/90 transform hover:scale-105">
        <span class="material-symbols-outlined">add</span>
        Invite Members
      </button>
    </div>
  </div>

  <!-- Members Card -->
  <div class="glassmorphism rounded-xl shadow-smooth">
    <!-- Card Header -->
    <div class="p-6 border-b border-border">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between">
        <h3 class="text-xl font-bold tracking-tight">Current Members</h3>
        <div class="flex gap-4 mt-4 md:mt-0">
          <div class="flex-grow">
            <input type="text" [(ngModel)]="searchQuery" placeholder="Search..." class="w-full px-4 py-3 bg-background border border-border rounded-md text-foreground focus:ring-0 focus:border-primary focus:shadow-input-focus transition-shadow duration-200">
          </div>
          <div class="w-full md:w-auto">
            <select [(ngModel)]="selectedRole" class="w-full px-4 py-3 bg-background border border-border rounded-md text-foreground focus:ring-0 focus:border-primary focus:shadow-input-focus transition-shadow duration-200">
              <option value="">All Roles</option>
              <option *ngFor="let role of roleOptions" [value]="role">{{ role | titlecase }}</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Members Table -->
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="filteredMembers" class="w-full">

        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Name</th>
          <td mat-cell *matCellDef="let member" class="p-4">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm" [ngClass]="getAvatarColor(member.id)">
                {{ getInitials(member) }}
              </div>
              <div>
                <p class="font-medium text-foreground">{{ member.firstName }} {{ member.lastName }}</p>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Email Column -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Email</th>
          <td mat-cell *matCellDef="let member" class="p-4 text-muted-foreground">{{ member.email }}</td>
        </ng-container>

        <!-- Role Column -->
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Role</th>
          <td mat-cell *matCellDef="let member" class="p-4">
            <span class="px-3 py-1 text-xs font-medium rounded-full" [ngClass]="getRoleChipClass(member.role)">
              {{ member.role | titlecase }}
            </span>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Status</th>
          <td mat-cell *matCellDef="let member" class="p-4">
            <span class="inline-flex items-center gap-1.5 px-3 py-1 text-xs font-medium rounded-full" [ngClass]="getStatusChipClass(member.status)">
              <span class="w-2 h-2 rounded-full" [ngClass]="getStatusIndicatorClass(member.status)"></span>
              {{ member.status | titlecase }}
            </span>
          </td>
        </ng-container>

        <!-- Joined Date Column -->
        <ng-container matColumnDef="joinedDate">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Joined Date</th>
          <td mat-cell *matCellDef="let member" class="p-4 text-muted-foreground">{{ member.joinedDate | date:'mediumDate' }}</td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-right text-sm font-semibold text-muted-foreground">Actions</th>
          <td mat-cell *matCellDef="let member" class="p-4 text-right">
            <button mat-icon-button [matMenuTriggerFor]="menu">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #menu="matMenu">
              <!-- <button mat-menu-item [disabled]="member.role === 'HIRING_MANAGER'" (click)="updateMemberRole(member.id, 'HIRING_MANAGER')">
                <mat-icon>admin_panel_settings</mat-icon>
                <span>Make Hiring Manager</span>
              </button>
              <button mat-menu-item [disabled]="member.role === 'RECRUITER'" (click)="updateMemberRole(member.id, 'RECRUITER')">
                <mat-icon>support_agent</mat-icon>
                <span>Make Recruiter</span>
              </button> -->
              <!-- <button mat-menu-item (click)="removeMember(member.id)">
                <mat-icon>delete</mat-icon>
                <span>Remove Member</span>
              </button> -->
            </mat-menu>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" class="bg-muted"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="border-b border-border hover:bg-muted/50 transition-colors"></tr>
      </table>
      <div *ngIf="isLoading" class="absolute inset-0 bg-background/80 flex items-center justify-center">
        <mat-progress-spinner color="primary" mode="indeterminate"></mat-progress-spinner>
      </div>
      <div *ngIf="!isLoading && filteredMembers.length === 0" class="text-center p-8 text-muted-foreground">
        <p>No members found.</p>
      </div>
    </div>
  </div>

  <!-- Pending Invitations Card -->
  <div class="mt-8 glassmorphism rounded-xl shadow-smooth">
    <div class="p-6 border-b border-border">
      <h3 class="text-xl font-bold tracking-tight">Pending Invitations</h3>
    </div>
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="pendingInvitations" class="w-full">

        <!-- Email Column -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Email</th>
          <td mat-cell *matCellDef="let invitation" class="p-4 text-muted-foreground">{{ invitation.email }}</td>
        </ng-container>

        <!-- Sent Date Column -->
        <ng-container matColumnDef="createdAt">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Sent Date</th>
          <td mat-cell *matCellDef="let invitation" class="p-4 text-muted-foreground">{{ invitation.createdAt | date:'mediumDate' }}</td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-left text-sm font-semibold text-muted-foreground">Status</th>
          <td mat-cell *matCellDef="let invitation" class="p-4">
            <span class="inline-flex items-center gap-1.5 px-3 py-1 text-xs font-medium rounded-full" [ngClass]="getStatusChipClass(invitation.status)">
              <span class="w-2 h-2 rounded-full" [ngClass]="getStatusIndicatorClass(invitation.status)"></span>
              {{ invitation.status | titlecase }}
            </span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="p-4 text-right text-sm font-semibold text-muted-foreground">Actions</th>
          <td mat-cell *matCellDef="let invitation" class="p-4 text-right">
            <!-- <button mat-icon-button (click)="resendInvitation(invitation.id)" matTooltip="Resend Invitation">
              <mat-icon>send</mat-icon>
            </button> -->
            <button mat-icon-button (click)="revokeInvitation(invitation.id)" matTooltip="Revoke Invitation">
              <mat-icon>cancel</mat-icon>
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="invitationColumns; sticky: true" class="bg-muted"></tr>
        <tr mat-row *matRowDef="let row; columns: invitationColumns;" class="border-b border-border hover:bg-muted/50 transition-colors"></tr>
      </table>
      <div *ngIf="!isLoading && pendingInvitations.length === 0" class="text-center p-8 text-muted-foreground">
        <p>No pending invitations.</p>
      </div>
    </div>
  </div>
</div>