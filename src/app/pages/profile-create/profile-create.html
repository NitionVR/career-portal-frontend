<div class="flex min-h-screen items-center justify-center p-6 sm:p-8 md:p-12 bg-background">
  <div class="w-full max-w-lg bg-card p-8 rounded-xl shadow-lg">
    <div class="text-center mb-8">
      <img src="/assets/logo.png" alt="eTalente Logo" class="h-12 w-12 mx-auto mb-4"/>
      <h1 class="text-3xl font-bold text-foreground mb-2">Complete Your Profile</h1>
      <p class="text-muted-foreground">Just a few more details to get started.</p>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex flex-col items-center justify-center py-12">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
      <p class="mt-4 text-muted-foreground">Loading your profile...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage && !isLoading" class="bg-destructive/20 text-destructive p-4 rounded-md mb-6" role="alert">
      <p class="font-medium">{{ errorMessage }}</p>
    </div>

    <!-- Form -->
    <form *ngIf="!isLoading && profileForm" [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-6">

      <!-- CANDIDATE FORM -->
      <ng-container *ngIf="userRole === 'CANDIDATE'">
        <div>
          <label class="block text-sm font-medium text-muted-foreground mb-1" for="username">
            Username <span class="text-destructive">*</span>
          </label>
          <input
            id="username"
            formControlName="username"
            type="text"
            autocomplete="username"
            placeholder="Enter your username"
            class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"
            [class.border-destructive]="hasError('username')"
            [class.border-border]="!hasError('username')"
          />
          <p *ngIf="hasError('username')" class="mt-1 text-sm text-destructive">
            {{ getErrorMessage('username') }}
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-muted-foreground mb-1" for="firstName">
              First Name <span class="text-destructive">*</span>
            </label>
            <input
              id="firstName"
              formControlName="firstName"
              type="text"
              autocomplete="given-name"
              placeholder="Enter your first name"
              class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"
              [class.border-destructive]="hasError('firstName')"
              [class.border-border]="!hasError('firstName')"
            />
            <p *ngIf="hasError('firstName')" class="mt-1 text-sm text-destructive">
              {{ getErrorMessage('firstName') }}
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-muted-foreground mb-1" for="lastName">
              Last Name <span class="text-destructive">*</span>
            </label>
            <input
              id="lastName"
              formControlName="lastName"
              type="text"
              autocomplete="family-name"
              placeholder="Enter your last name"
              class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"
              [class.border-destructive]="hasError('lastName')"
              [class.border-border]="!hasError('lastName')"
            />
            <p *ngIf="hasError('lastName')" class="mt-1 text-sm text-destructive">
              {{ getErrorMessage('lastName') }}
            </p>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-muted-foreground mb-1">
              Gender
              <app-custom-select id="gender" formControlName="gender" [options]="genderOptions" placeholder="Select your gender"></app-custom-select>
            </label>
          </div>
          <div>
            <label class="block text-sm font-medium text-muted-foreground mb-1">
              Race
              <app-custom-select id="race" formControlName="race" [options]="raceOptions" placeholder="Select your race"></app-custom-select>
            </label>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-muted-foreground mb-1">
            Disability Status
            <app-custom-select id="disability" formControlName="disability" [options]="disabilityOptions" placeholder="Select an option"></app-custom-select>
          </label>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                  <div>

                    <label class="block text-sm font-medium text-muted-foreground mb-1" for="contactNumber">

                      Contact Number <span class="text-destructive">*</span>

                    </label>

                    <div class="phone-input-wrapper">

                                    <ngx-intl-tel-input

                                      [cssClass]="'custom-phone-input'"

                                      [preferredCountries]="['us', 'gb', 'za']"

                                      [enableAutoCountrySelect]="true"

                                      [enablePlaceholder]="true"

                                      [searchCountryFlag]="true"

                                      [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"

                                      [selectFirstCountry]="false"

                                      [selectedCountryISO]="CountryISO.UnitedStates"

                                      [maxLength]="15"

                                      [phoneValidation]="true"

                                                      [separateDialCode]="true"

                                                      [numberFormat]="PhoneNumberFormat.International"

                                                      name="phone"

                                                      formControlName="contactNumber">

                                                    </ngx-intl-tel-input>

                    </div>

                    <p *ngIf="hasError('contactNumber')" class="mt-1 text-sm text-destructive">

                      {{ getErrorMessage('contactNumber') }}

                    </p>

                  </div>

                  <div>

                    <label class="block text-sm font-medium text-muted-foreground mb-1" for="alternateContactNumber">

                      Alternate Contact <span class="text-muted-foreground text-xs">(Optional)</span>

                    </label>

                    <input

                      id="alternateContactNumber"

                      formControlName="alternateContactNumber"

                      type="tel"

                      autocomplete="tel-national"

                      placeholder="e.g., +1987654321"

                      class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"

                      [class.border-destructive]="hasError('alternateContactNumber')"

                      [class.border-border]="!hasError('alternateContactNumber')"

                    />

                    <p *ngIf="hasError('alternateContactNumber')" class="mt-1 text-sm text-destructive">

                      {{ getErrorMessage('alternateContactNumber') }}

                    </p>

                  </div>

                </div>

              </ng-container>

        

              <!-- HIRING MANAGER FORM -->

              <ng-container *ngIf="userRole === 'HIRING_MANAGER'">

                <div>

                  <label class="block text-sm font-medium text-muted-foreground mb-1" for="hm_username">

                    Username <span class="text-destructive">*</span>

                  </label>

                  <input

                    id="hm_username"

                    formControlName="username"

                    type="text"

                    autocomplete="username"

                    placeholder="Enter your username"

                    class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"

                    [class.border-destructive]="hasError('username')"

                    [class.border-border]="!hasError('username')"

                  />

                  <p *ngIf="hasError('username')" class="mt-1 text-sm text-destructive">

                    {{ getErrorMessage('username') }}

                  </p>

                </div>

        

                <div>

                  <label class="block text-sm font-medium text-muted-foreground mb-1" for="hm_companyName">

                    Company Name <span class="text-destructive">*</span>

                  </label>

                  <input

                    id="hm_companyName"

                    formControlName="companyName"

                    type="text"

                    autocomplete="organization"

                    placeholder="Enter your company name"

                    class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"

                    [class.border-destructive]="hasError('companyName')"

                    [class.border-border]="!hasError('companyName')"

                  />

                  <p *ngIf="hasError('companyName')" class="mt-1 text-sm text-destructive">

                    {{ getErrorMessage('companyName') }}

                  </p>

                </div>

        

                <div>

                  <label class="block text-sm font-medium text-muted-foreground mb-1">

                    Industry <span class="text-destructive">*</span>

                  

                    <app-custom-select

                      id="hm_industry"

                      formControlName="industry"

                      [options]="industryOptions"

                      placeholder="Select your industry">

                    </app-custom-select>

                  </label>

                  <p *ngIf="hasError('industry')" class="mt-1 text-sm text-destructive">

                    {{ getErrorMessage('industry') }}

                  </p>

                </div>

        

                <div>

                  <label class="block text-sm font-medium text-muted-foreground mb-1" for="hm_contactPerson">

                    Contact Person <span class="text-destructive">*</span>

                  </label>

                  <input

                    id="hm_contactPerson"

                    formControlName="contactPerson"

                    type="text"

                    autocomplete="name"

                    placeholder="Enter contact person's name"

                    class="w-full px-4 py-3 bg-background border rounded-md text-foreground focus:ring-0 focus:border-primary transition-all duration-200"

                    [class.border-destructive]="hasError('contactPerson')"

                    [class.border-border]="!hasError('contactPerson')"

                  />

                  <p *ngIf="hasError('contactPerson')" class="mt-1 text-sm text-destructive">

                    {{ getErrorMessage('contactPerson') }}

                  </p>

                </div>

                <div>

                  <label class="block text-sm font-medium text-muted-foreground mb-1" for="hm_contactNumber">

                    Contact Number <span class="text-destructive">*</span>

                  </label>

                  <div class="phone-input-wrapper">

                    <ngx-intl-tel-input

                      [cssClass]="'custom-phone-input'"

                      [preferredCountries]="['us', 'gb', 'za']"

                      [enableAutoCountrySelect]="true"

                      [enablePlaceholder]="true"

                      [searchCountryFlag]="true"

                      [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"

                      [selectFirstCountry]="false"

                      [selectedCountryISO]="CountryISO.UnitedStates"

                      [maxLength]="15"

                      [phoneValidation]="true"

                      [separateDialCode]="true"

                      [numberFormat]="PhoneNumberFormat.International"

                      name="phone"

                      formControlName="contactNumber">

                    </ngx-intl-tel-input>

                  </div>

                  <p *ngIf="hasError('contactNumber')" class="mt-1 text-sm text-destructive">

                    {{ getErrorMessage('contactNumber') }}

                  </p>

                </div>
      </ng-container>

      <!-- Submit Button -->
      <button
        type="submit"
        [disabled]="isSubmitting"
        class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-base font-medium text-primary-foreground bg-primary hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background focus:ring-primary transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"
      >
        <span *ngIf="!isSubmitting">Complete Registration</span>
        <span *ngIf="isSubmitting" class="flex items-center">
          <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-primary-foreground" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Processing...
        </span>
      </button>
    </form>
  </div>
</div>
