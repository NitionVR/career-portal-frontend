<div class="p-6">
  <h2 mat-dialog-title class="text-2xl font-bold text-foreground mb-2">Autofill Profile</h2>
  <p class="text-muted-foreground mb-6">Choose a CV to autofill your profile information. This will overwrite existing data in your profile form.</p>

  <div class="space-y-4">
    <mat-radio-group [(ngModel)]="selectedResume" class="space-y-3">
      <!-- Option for uploading a new CV -->
      <mat-radio-button value="new" (click)="triggerFileInput(fileInput)" class="w-full">
        <div class="p-4 border rounded-lg flex items-center justify-between w-full cursor-pointer" [class.border-primary]="selectedResume === 'new'" [class.ring-2]="selectedResume === 'new'" [class.ring-primary]="selectedResume === 'new'">
          <div class="flex items-center">
            <mat-icon class="mr-3">upload_file</mat-icon>
            <span class="font-semibold">Upload a new CV</span>
          </div>
        </div>
      </mat-radio-button>
      <input type="file" class="hidden" #fileInput (change)="onFileSelected($event)" accept=".pdf,.doc,.docx"/>

      <!-- Options for existing CVs -->
      <mat-radio-button *ngFor="let resume of resumes" [value]="resume" class="w-full">
        <div class="p-4 border rounded-lg flex items-center justify-between w-full" [class.border-primary]="selectedResume === resume" [class.ring-2]="selectedResume === resume" [class.ring-primary]="selectedResume === resume">
          <div class="flex items-center">
            <mat-icon class="mr-3">description</mat-icon>
            <div class="text-left">
              <p class="font-medium">{{ resume.filename }}</p>
              <p class="text-xs text-muted-foreground">Uploaded: {{ resume.uploadDate | date:'mediumDate' }}</p>
            </div>
          </div>
        </div>
      </mat-radio-button>
    </mat-radio-group>

    <div *ngIf="resumes.length === 0" class="text-center text-muted-foreground p-4 border border-dashed rounded-lg">
      You have no existing CVs to choose from. Please upload one.
    </div>
  </div>

  <div class="flex justify-end gap-3 mt-8">
    <button mat-button (click)="onCancel()">Cancel</button>
    <button mat-raised-button color="primary" (click)="confirmSelection()" [disabled]="!selectedResume || selectedResume === 'new'">Use Selected CV</button>
  </div>
</div>
